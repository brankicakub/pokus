# Fortran Implementation Documentation

Overview
--------

This document describes the Fortran90 implementation in `fortran/src/main.f90`.
The program reads a CSV file, selects two columns (X and Y), writes a two-column data file `output/tmpdata.dat`, and generates a `gnuplot` script `output/plot.plt`. A helper script (`fortran/run_plot.sh`) invokes `gnuplot` to render PDF/PNG outputs.

Build & Run
-----------

From the repository root:

```bash
make -C fortran run
```

This compiles `fortran/src/main.f90`, runs it against `data/sample.csv` in `--auto` mode (non-interactive), creates `output/tmpdata.dat` and `output/plot.plt`, then calls `gnuplot` to produce `output/plot.pdf` and `output/plot.png`.

Command-line
------------

- First argument: path to CSV file (required). Example: `../data/sample.csv`.
- Second argument: optional flag `--auto` or `-a` to run in automatic mode (choose first column for X and second for Y). Without `--auto` the program runs interactively and prompts for X/Y columns.

CSV format
----------

The program expects a header row with comma-separated column names and subsequent rows with comma-separated values. Non-numeric X values are converted to a row index automatically in `--auto` mode.

Files and Outputs
-----------------

- `output/tmpdata.dat` — two-column numeric data (X Y) used by `gnuplot`.
- `output/plot.plt` — a `gnuplot` script generated by the program.
- `output/plot.pdf`, `output/plot.png` — generated by running the `gnuplot` script.

Behavior & Error Handling
------------------------

- If the CSV file cannot be opened the program exits with a non-zero status.
- If the user supplies invalid column names during interactive mode the program defaults to column 1 for that axis.
- In non-interactive `--auto` mode the program uses column 1 for X and column 2 for Y (if present); if X is non-numeric, the program uses the row index as X values.

Extending the Fortran code
--------------------------

- To support parsing ISO date strings into numeric X values you can add a small parser that converts `YYYY-MM-DD` to a numeric time value (e.g., days since epoch).
- To accept different CSV separators change the tokenization logic in `get_token`.

Questions
---------

If you'd like, I can:

- Add date parsing for `YYYY-MM-DD` to plot timeseries on the X axis.
- Improve interactive input validation (re-prompt on invalid input).
- Add more robust CSV parsing (quoted fields, different separators).
